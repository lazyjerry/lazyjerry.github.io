---
applyTo: "docs/**/*.md"
description: "專案變更日誌文件生成規範"
---

# 變更日誌文件自動生成指令

供 AI 代理在完成專案變更任務後自動產生變更日誌文件的規範與格式。

---

## 觸發條件

**AI 代理必須在以下情況完成後自動建立變更日誌：**

1. **任務執行完成** - 當 AI 完成用戶指派的開發任務後
2. **重大變更** - 進行重構、新增功能或重大修改後
3. **多檔案變更** - 變更超過 5 個檔案或 100 行程式碼後
4. **架構調整** - 涉及系統架構或配置的重要變更後

**執行時機：** AI 任務執行的最後步驟，在提交程式碼變更之前。

---

## 目標

- 記錄所有專案變更邏輯、變更的檔案目錄名稱
- 提供清晰的變更說明和技術細節
- 便於團隊成員理解變更內容和影響
- 建立可追蹤的變更歷史

---

## 檔案位置與命名規範

### 目錄結構（按目標檔案位置分類）

**組織原則**：

1. **第一層**：按照修改的目標檔案所在資料夾分類
2. **第二層**：按照功能類型細分（reports、guides、specs、archive）

```
docs/
├── www/
│   └── frontend/              # 對應 www/frontend/ 的變更文件
│       ├── reports/           # 完成報告和實作記錄
│       ├── guides/            # 使用指南和參考
│       ├── specs/             # 規格和技術分析
│       └── archive/           # 已歸檔的過時文件
├── backend/                   # 對應 backend/ 的變更文件（如有）
│   ├── reports/
│   ├── guides/
│   └── specs/
└── database/                  # 對應 database/ 的變更文件（如有）
    ├── reports/
    └── specs/
```

### 分類邏輯說明

**步驟 1：確定目標檔案位置**

- 檢視此次變更主要修改哪個資料夾的檔案
- 在 `docs/` 下建立對應的資料夾結構

**步驟 2：選擇功能分類**

- `reports/` - 功能完成報告、整合報告、修復報告
- `guides/` - 使用指南、快速開始、測試指南
- `specs/` - 技術規格、設計文件、API 規格
- `archive/` - 已過時或已完成的歷史文件

### 實際範例

#### 範例 1：前端功能重構

**變更內容**：重構 `www/frontend/js/controllers/` 中的控制器

**文件位置**：

```
docs/www/frontend/reports/階段1-3整合修復報告.md
```

**原因**：

- 目標檔案在 `www/frontend/` → 文件放在 `docs/www/frontend/`
- 是完成報告 → 放在 `reports/` 子目錄

#### 範例 2：前端使用指南

**變更內容**：為 `www/frontend/` 建立快速開始文件

**文件位置**：

```
docs/www/frontend/guides/快速開始.md
```

**原因**：

- 目標是 `www/frontend/` → 文件放在 `docs/www/frontend/`
- 是使用指南 → 放在 `guides/` 子目錄

#### 範例 3：通知系統修復

**變更內容**：修復 `www/frontend/js/utils/NotificationHelper.js` 和 `VisualFeedbackHelper.js`

**文件位置**：

```
docs/www/frontend/reports/通知位置修復報告.md
```

**原因**：

- 目標檔案在 `www/frontend/js/utils/` → 文件放在 `docs/www/frontend/`
- 是修復報告 → 放在 `reports/` 子目錄

#### 範例 4：CSS 技術分析

**變更內容**：分析 `www/frontend/css/` 的樣式衝突

**文件位置**：

```
docs/www/frontend/specs/CSS衝突分析.md
```

**原因**：

- 目標檔案在 `www/frontend/css/` → 文件放在 `docs/www/frontend/`
- 是技術分析 → 放在 `specs/` 子目錄

#### 範例 5：後端 API 開發（假設）

**變更內容**：開發 `backend/api/v1/` 的新端點

**文件位置**：

```
docs/backend/reports/API-V1功能開發報告.md
docs/backend/specs/API-V1規格文件.md
```

**原因**：

- 目標檔案在 `backend/` → 文件放在 `docs/backend/`
- 報告放 `reports/`，規格放 `specs/`

### 檔案命名格式

**使用繁體中文命名，清晰易讀：**

```
docs/{目標資料夾}/{功能分類}/{中文描述}.md
```

**命名規則**：

- 使用繁體中文
- 簡潔明確，避免冗長
- 必要時可加入編號前綴（如 `T019-`、`階段3-`）

### 變更類型（簡化）

- `功能` - 新功能實作
- `重構` - 程式碼重構
- `修復` - 問題修復
- `更新` - 功能更新
- `整合` - 系統整合
- `報告` - 完成報告

### 完整命名範例

**基於目標檔案位置的文件路徑：**

| 變更的目標檔案                 | 文件類型 | 文件路徑                                           |
| ------------------------------ | -------- | -------------------------------------------------- |
| `www/frontend/js/controllers/` | 整合報告 | `docs/www/frontend/reports/階段1-3整合修復報告.md` |
| `www/frontend/js/utils/`       | 修復報告 | `docs/www/frontend/reports/通知位置修復報告.md`    |
| `www/frontend/`                | 使用指南 | `docs/www/frontend/guides/快速開始.md`             |
| `www/frontend/`                | 測試指南 | `docs/www/frontend/guides/整合測試檢查清單.md`     |
| `www/frontend/css/`            | 技術分析 | `docs/www/frontend/specs/CSS衝突分析.md`           |
| `www/frontend/game.html`       | 更新指南 | `docs/www/frontend/guides/HTML更新指南.md`         |

---

## 文件結構規範

### 必要章節

```markdown
# {變更標題}

## 變更概要

簡要說明此次變更的目的和範圍

## 問題分析

描述變更前遇到的問題或需要改進的地方

## 解決方案

詳細說明採用的解決方案和實作方法

## 變更內容

列出具體的變更項目和檔案

## 測試結果

說明測試覆蓋率和測試結果

## 影響評估

分析變更對現有功能的影響

## 使用指南

提供新功能或變更後功能的使用方法

## 未來改進

列出可能的進一步改進方向
```

### 可選章節

- `技術細節` - 深入的技術實作說明
- `相關連結` - 相關文件或資源連結
- `注意事項` - 使用或維護時需要注意的事項
- `相容性說明` - 向下相容性或破壞性變更說明

---

## 內容格式規範

### 1. 標題規範

- 使用繁體中文
- 層級清晰，最多使用到 H4 (####)
- 具體明確，避免模糊表達

### 2. 程式碼區塊

````markdown
# PHP 程式碼

```php
class ExampleService
{
    public function example(): array
    {
        return ['status' => 'success'];
    }
}
```
````

# Bash 指令

```bash
./vendor/bin/sail test tests/Feature/ExampleTest.php
```

# 設定檔案

```env
APP_ENV=production
FEATURE_ENABLED=true
```

```

### 3. 檔案路徑格式

- 使用相對路徑，從專案根目錄開始
- 使用反引號標記：`app/Services/ExampleService.php`
- 目錄結構使用樹狀圖：

```

app/
├── Http/Controllers/
│ ├── API/V1/
│ └── Web/
├── Services/
└── Models/

````

### 4. 狀態標記

使用 emoji 標記重要狀態：

- ✅ **完成** - 已完成的項目
- ⚠️ **注意** - 需要注意的事項
- 🔧 **修復** - 問題修復
- 🆕 **新增** - 新功能
- 🔄 **變更** - 功能變更
- 📋 **測試** - 測試相關
- 🎯 **重要** - 重要資訊

### 5. 統計資料格式

```markdown
**測試統計:**
- **總測試數**: 19 個測試，66 個斷言
- **通過率**: 100% ✅
- **測試分類**:
  - EmailVerificationServiceTest: 8 個測試
  - Web EmailVerificationTest: 6 個測試
  - API EmailVerificationTest: 5 個測試
````

---

## 品質要求

### 1. 內容品質

- **準確性**: 所有技術細節必須準確
- **完整性**: 包含所有必要的資訊
- **清晰性**: 表達清楚，易於理解
- **可操作性**: 提供具體的操作步驟

### 2. 語言規範

- 使用台灣繁體中文
- 避免簡體中文或中國用語
- 技術術語保持一致性
- 語句通順，邏輯清晰

**禁止使用主觀形容詞與誇大修飾：**

以下詞彙**嚴禁使用**，因其會引導使用者期待或產生誤導：

❌ **禁用詞彙**：

- 「專業的」、「企業級」、「強大的」、「優秀的」
- 「完善的」、「高效的」、「先進的」、「卓越的」
- 「最佳的」、「一流的」、「頂級的」、「極致的」
- 「完美的」、「絕佳的」、「傑出的」、「領先的」

✅ **正確表達方式**：

- 陳述客觀事實：「支援 XXX 功能」而非「強大的 XXX 功能」
- 描述具體數據：「回應時間 < 100ms」而非「高效的回應速度」
- 說明實際效果：「減少程式碼重複 30%」而非「優秀的程式碼品質」

**範例對比**：

| ❌ 錯誤表達                | ✅ 正確表達                           |
| -------------------------- | ------------------------------------- |
| 「這是一個專業的解決方案」 | 「這個解決方案實作了 A、B、C 功能」   |
| 「採用了先進的架構設計」   | 「採用模組化架構，包含 6 個獨立模組」 |
| 「提供完善的錯誤處理機制」 | 「捕捉並記錄 5 種類型的錯誤」         |
| 「高效的效能最佳化」       | 「載入時間從 2s 降至 0.8s」           |

### 3. 程式碼品質

- 所有程式碼範例必須可執行
- 提供完整的上下文
- 包含必要的 import 和 namespace
- 遵循專案的程式碼風格

---

## 自動檔案管理規範

### 1. 目錄建立原則

**AI 代理執行步驟：**

1. 確認目標檔案所在資料夾（如 `www/frontend/`）
2. 在 `docs/` 下建立對應結構（如 `docs/www/frontend/`）
3. 根據文件類型選擇子目錄（`reports/`、`guides/`、`specs/`、`archive/`）
4. 確認目錄存在，若不存在則建立

### 2. 檔案關聯與索引

**文件管理：**

- 在主 `README.md` 中更新變更日誌索引
- 在相關功能文件中引用對應變更
- 保持文件之間的交叉引用一致性

### 3. 歸檔策略

**長期維護：**

- 完成的功能報告移至 `archive/` 目錄
- 過時的技術分析移至 `archive/` 目錄
- 保持 `reports/`、`guides/`、`specs/` 目錄中的文件為活躍狀態

---

## 範例檔案參考

### 現有文件結構範例

**前端相關文件：**

```
docs/www/frontend/
├── reports/
│   ├── 階段1-3整合修復報告.md
│   ├── 通知位置修復報告.md
│   └── 遊戲主檔重構-階段3報告.md
├── guides/
│   ├── 快速開始.md
│   ├── 整合測試檢查清單.md
│   └── 模板系統指南.md
├── specs/
│   └── CSS衝突分析.md
└── archive/
    ├── v2.13.1錯誤修復.md
    └── 回退機制移除報告.md
```

**後端相關文件（範例）：**

```
docs/backend/
├── reports/
│   └── API-V1功能開發報告.md
└── specs/
    └── API-V1規格文件.md
```

---

## AI 檔案建立流程

### 1. 建立前的分析步驟

**AI 代理執行順序：**

1. **分析變更範圍** - 檢查修改的檔案和變更內容
2. **確定目標位置** - 識別主要修改的資料夾（如 `www/frontend/`）
3. **選擇文件類型** - 根據內容性質選擇 `reports/`、`guides/`、`specs/` 或 `archive/`
4. **生成檔案名稱** - 使用繁體中文，簡潔明確
5. **建立目錄結構** - 若目錄不存在則建立
6. **填寫文件內容** - 按照標準模板填寫

### 2. 文件模板

**標準章節結構：**

```markdown
# {變更標題}

## 變更概要

{此次變更的目的和範圍}

## 問題分析

{變更前遇到的問題}

## 解決方案

{採用的解決方案和實作方法}

## 變更內容

{具體變更的檔案和程式碼}

## 測試結果

{測試覆蓋率和結果}

## 影響評估

{對現有功能的影響}

## 使用指南

{新功能或變更後的使用方法}

## 未來改進

{後續改進方向}
```

### 3. 檔案建立檢查清單

**建立文件前確認：**

- 已確認觸發條件（任務完成/重大變更/多檔案變更/架構調整）
- 目標資料夾位置正確（對應實際修改的檔案位置）
- 文件類型分類正確（reports/guides/specs/archive）
- 檔案命名符合規範（繁體中文、簡潔明確）
- 包含所有必要章節
- 程式碼範例可執行
- 禁用詞彙檢查通過

### 4. 實際執行範例

**情境：用戶請求「請重構前端控制器」**

```
步驟 1: 分析變更範圍
→ 修改了 www/frontend/js/controllers/ 中的 5 個檔案

步驟 2: 確定目標位置
→ 目標：www/frontend/ → 文件位置：docs/www/frontend/

步驟 3: 選擇文件類型
→ 是重構報告 → 分類：reports/

步驟 4: 生成檔案名稱
→ 控制器重構報告.md

步驟 5: 建立目錄結構
→ 確認 docs/www/frontend/reports/ 存在

步驟 6: 填寫文件內容
→ 建立檔案：docs/www/frontend/reports/控制器重構報告.md
→ 按模板填寫內容
```

---

## AI 品質保證責任

### 1. 文件檢視與維護

**每次建立文件時：**

- 檢查目錄結構與實際檔案位置對應正確
- 驗證文件內容的準確性和完整性
- 確認檔案命名符合繁體中文規範
- 檢查是否使用禁用詞彙

### 2. 內容品質標準

**必須確保：**

- 所有程式碼範例可執行且正確
- 所有檔案路徑和連結有效
- 使用台灣繁體中文和正確技術術語
- 提供完整的變更影響分析
- 包含具體可操作的使用指南

### 3. 持續改進

**根據實際使用：**

- 最佳化文件結構和組織方式
- 改進變更描述的清晰度
- 保持與專案技術演進同步
- 收集並應用文件撰寫的最佳實踐

---

## 注意事項

### 不應執行的操作

**AI 不應自動執行以下操作：**

- ❌ 自動提交檔案到 Git 版本控制
- ❌ 自動推送變更到遠端儲存庫
- ❌ 自動刪除或移動現有文件（除非用戶明確要求）
- ❌ 自動修改 `.gitignore` 或其他配置檔案

### 應該執行的操作

**AI 應該執行：**

- ✅ 建立新的變更日誌文件
- ✅ 填寫完整的文件內容
- ✅ 建立必要的目錄結構
- ✅ 提供文件內容給用戶確認

### 用戶確認流程

**建立文件後：**

1. 向用戶展示建立的文件路徑
2. 說明文件的主要內容
3. 等待用戶確認或要求修改
4. 由用戶決定是否提交到版本控制

---

這些規範確保 AI 代理建立高品質、結構清晰的變更日誌，同時保持適當的自動化界限，讓用戶保有最終控制權。
